%!TEX TS-program = xelatex
% !TeX program = xelatex
\documentclass{article}
\usepackage[margin=1in]{geometry}
\usepackage{xeCJK}
\usepackage{ruby}
\setCJKmainfont{NotoSansJP-Light.otf}
\usepackage{tikz}

% characters with big height and depth
% to give different boxes the same vertical size
\newcommand{\vsizecorrectorhira}{\vphantom{もりぼゃ}}% epkyouka, HanaMinA
\newcommand{\vsizecorrectorkanji}{\vphantom{$\vert$}}

% commands for setting furigana below kanji
\newcommand{\furigana}[2]{% #1: kanji, #2: furigana
    %\unskip
    \begin{tikzpicture}[baseline=(kanji.base)]
        \node(kanji)[
            inner sep=0,
        ] {
            \vsizecorrectorkanji%
            #1%
        };
        \node(furigana)[
            below of=kanji,
            node distance=1em-2pt,
            inner sep=0,
        ] {%
            \tiny%
            \vsizecorrectorhira%
            #2%
        };
    \end{tikzpicture}%
    %\ignorespaces
}

\newcommand{\furiganaAboveBelow}[3]{% #1: kanji, #2: furigana above, #3: furigana below
    %\unskip
    \begin{tikzpicture}[baseline=(kanji.base)]
        \node(kanji)[
            inner sep=0,
        ] {
            \vsizecorrectorkanji%
            #1%
        };
        \node(furigana-above)[
            above of=kanji,
            node distance=1em,
            inner sep=0,
        ] {%
            \tiny%
            \vsizecorrectorhira%
            #2%
        };
        \node(furigana-below)[
            below of=kanji,
            node distance=1em-2pt,
            inner sep=0,
        ] {%
            \tiny%
            \vsizecorrectorhira%
            #3%
        };
    \end{tikzpicture}%
    %\ignorespaces
}

\begin{document}
Japanese uses different alphabets, one of those is \furigana{漢字}{かんじ} (Kanji).

rstdrstdsrtd

Kanji can have different readings: \furiganaAboveBelow{日}{にち}{ひ}.
\end{document}
